/**
 * 该插件必须依赖jquery
 * 根据指定传入json对象设置雪的参数
 * 默认的雪的的规格是
 * minSize: 10,//表示最小的雪花
 * maxSize: 20,//表示最大的雪花
 * newOn: 500,//表示每过500毫秒就随机产生一朵雪花
 * flakeColor: "#FFFFFF"//表示雪花的颜色
 */

(function($) {
    $.fn.snow = function(options) {
        var $flake = $('<div id="flake" />').css({
            'position': 'absolute',
            'top': '-50px'
        }).html('&#10052;'),
        documentHeight = $(document).height(),
        documentWidth = $(document).width(),
        defaults = {
            minSize: 10,
            maxSize: 20,
            newOn: 500,
            flakeColor: "#FFFFFF"
        },
        options = $.extend({},
        defaults, options);
        var interval = setInterval(function() {
            var startPositionLeft = Math.random() * documentWidth - 100,
            startOpacity = 0.5 + Math.random(),
            sizeFlake = options.minSize + Math.random() * options.maxSize,
            endPositionTop = documentHeight - 40,
            endPositionLeft = startPositionLeft - 100 + Math.random() * 200,
            durationFall = documentHeight * 10 + Math.random() * 5000;
            $flake.clone().appendTo('body').css({
                left: startPositionLeft,
                opacity: startOpacity,
                'font-size': sizeFlake,
                color: options.flakeColor
            }).animate({
                top: endPositionTop,
                left: endPositionLeft,
                opacity: 0.2
            },
            durationFall, 'linear',
            function() {
                $(this).remove()
            });
        },
        options.newOn);
    };
})(jQuery);
